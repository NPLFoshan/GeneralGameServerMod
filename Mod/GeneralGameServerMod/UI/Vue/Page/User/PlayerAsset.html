<template style="padding: 6px; width: 100%;">
    <div ref="list" style="width: 100%; height: 100%; overflow-y: auto;">
        <div v-for="asset, key in PlayerAssetList" v-bind:class="AssetContainerClass(asset)" onclick=ClickPlayerAsset(asset)>
            <div class="selected" style="position: absolute; left: 3px; top: 3px; width: 168px; height: 224px; background: url(Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/renwubj3_168X224_32bits.png#0 0 168 224);"></div>
            <div v-bind:style="AssetStyle(asset)"></div>
            <div class="use-btn"></div>
        </div>
    </div>
</template>

<script type="text/lua">
local EntityManager = commonlib.gettable("MyCompany.Aries.Game.EntityManager");

PlayerAssetList = GetAllAssets();
<!-- PlayerAssetList = {
    {
        id = 1,
        icon = "Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/nan_108X176_32bits.png#0 0 108 176",
        modelUrl = "character/CC/02human/paperman/boy01.x",
        owned = true,
    },
    {
        id = 2,
        icon = "Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/nan_108X176_32bits.png#0 0 108 176",
        modelUrl = "character/CC/02human/paperman/boy02.x",
        owned = true,
    },
    {
        id = 3,
        icon = "Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/nan_108X176_32bits.png#0 0 108 176",
        modelUrl = "character/CC/02human/paperman/boy03.x",
        owned = true,
    },
    {
        id = 4,
        icon = "Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/nan_108X176_32bits.png#0 0 108 176",
        modelUrl = "character/CC/02human/paperman/boy04.x",
        owned = true,
    },
}; -->

local function ChangePlayerAsset(assetfile)
	assetfile = EntityManager.PlayerAssetFile:GetValidAssetByString(assetfile);
	local playerEntity = GameLogic.GetPlayerController():GetPlayer();
	if(assetfile and assetfile~=playerEntity:GetMainAssetPath()) then
		local oldAssetFile = playerEntity:GetMainAssetPath()
		if(playerEntity.SetModelFile) then
			playerEntity:SetModelFile(assetfile);
		else
			playerEntity:SetMainAssetPath(assetfile);
        end
        GameLogic.options:SetMainPlayerAssetName(assetfile);
        GetGlobalScope():Set("MainAsset", assetfile);
		-- this ensure that at least one default skin is selected
		if(playerEntity:GetSkin()) then
			playerEntity:SetSkin(nil);
		else
			playerEntity:RefreshSkin();
		end
		if(math.abs(EntityManager.PlayerAssetFile:GetDefaultScale(oldAssetFile) - playerEntity:GetScaling()) < 0.01) then
			playerEntity:SetScaling(EntityManager.PlayerAssetFile:GetDefaultScale(assetfile))
		end
	end
end 

function ClickPlayerAsset(asset)
    if (not asset.owned) then return end

    ChangePlayerAsset(asset.modelUrl);
    UpdatePlayerEntityInfo();
end

function AssetContainerClass(asset) 
    return "asset-container " .. (asset.modelUrl == MainAsset and "used-asset-container" or (asset.owned and "unused-asset-container" or ""));
end

function AssetStyle(asset)
    local icon = asset.icon;
    if (not string.match(icon, "#%d+%s+%d+%s+%d+%s+%d+%s*")) then
        icon = icon .. "#0 0 108 176";
    end
    return string.format("width: 108px; height: 176px; background:url(%s)", icon);
end

function OnReady()
    SetScrollElement(GetRef("list"));
end 

function OnAttrValueChange()
end
</script>

<style>
.asset-container {
    display: inline-flex; 
    justify-content: center;
    align-items: center;
    width: 174px; 
    height: 235px; 
    margin-right: 20px;
    background:url(Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/renwubj4_174X235_32bits.png#0 0 174 235);
}

.used-asset-container {
    background:url(Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/renwubj_174X235_32bits.png#0 0 174 235);
}

.selected {
    visibility: hidden;
}

.used-asset-container>.selected {
    visibility: visible;
}

.unused-asset-container {
    background:url(Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/renwubj2_174X235_32bits.png#0 0 174 235);
}

.use-btn {
    visibility: hidden;
    position: absolute; 
    right: 15px; 
    bottom: 15px; 
    width: 30px; 
    height: 14px; 
    background: url(Texture/Aries/Creator/keepwork/ggs/user/renwuqiehuan/zi_shiyong_30X14_32bits.png#0 0 30 14);
}

.unused-asset-container .use-btn {
    visibility: visible;
}
</style>