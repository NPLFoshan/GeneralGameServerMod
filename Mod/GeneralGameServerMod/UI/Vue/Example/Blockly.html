<template class="container">
    <template class="header-container">
        <div class="title">图块编程</div>
        <div style="display: flex;">
            <div onclick=ClickBlockly class="text">图块</div>
            <div onclick=ClickCode class="text">代码</div>
            <div onclick=ClickExec class="text">运行</div>
        </div>
        <div onclick=CloseWindow class="btn" style="width: 22px; height: 22px; background: url(Texture/Aries/Creator/keepwork/ggs/dialog/guanbi_22X22_32bits.png#0 0 22 22);"></div>
    </template>
    <Blockly v-show="tab == 'blockly'" ref="blockly" class="tab-item"></Blockly>
    <div v-show="tab == 'code'" class="tab-item text-code">{{code}}</div>
    <div v-show="tab == 'exec'" class="tab-item text-code">{{out}}</div>
</template>

<script type="text/lua">
RegisterComponent("WindowTitleBar", "%vue%/Components/WindowTitleBar.html");

local BlocklyEl = nil;

tab = "blockly";
code = "";
out = "";

-- 组件解析完成
function OnReady()
    BlocklyEl = GetRef("blockly");
end

function ClickBlockly()
    tab = "blockly";
end

function ClickCode()
    local rawcode, prettycode = BlocklyEl:GetCode();
    code = prettycode;
    tab = "code";
    print(code);
end

function ClickExec()
    tab = "exec";
    local rawcode, prettycode = BlocklyEl:GetCode();
    out = BlocklyEl:ExecCode(rawcode);
end
</script>

<style>
.container {
    height: 100%; 
    width: 100%; 
    display: flex;
    flex-direction: column;
    padding: 2px;
    background: url(Texture/Aries/Creator/keepwork/Window/dakuang_32bits.png#0 0 440 93:378 43 33 44);
}

.header-container {
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    color: #ffffff;
    height: 37px;
    width: 100%;
    font-size: 16px;
    padding: 0px 20px;
}

.tab-item {
    width: 100%; 
    flex: 1;
}

.text-code {
    white-space: pre;
    font-size: 16px;
    padding: 16px;
}
</style>